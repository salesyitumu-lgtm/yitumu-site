---
const { title, lang, settings } = Astro.props;
const nav = Astro.props.nav ?? [];
const ui = Astro.props.ui ?? { blog: 'Blog', about: 'About', contact: 'Contact', langLabel: 'Language' };
---
<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <style>
      :root{--bg:#0b0d12;--card:#121726;--text:#e7e9ee;--muted:#a8b0c2;--link:#7aa7ff;--border:#232b40;}
      body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:var(--bg);color:var(--text);}
      a{color:var(--link);text-decoration:none}
      a:hover{text-decoration:underline}
      header{position:sticky;top:0;z-index:10;background:rgba(11,13,18,.9);backdrop-filter: blur(8px);border-bottom:1px solid var(--border);}
      .wrap{max-width:1100px;margin:0 auto;padding:16px;}
      .row{display:flex;align-items:center;gap:14px;flex-wrap:wrap}
      .brand{font-weight:800;letter-spacing:.4px}
      nav{display:flex;gap:14px;flex-wrap:wrap}
      .pill{padding:8px 10px;border:1px solid var(--border);border-radius:999px;background:rgba(255,255,255,.03)}
      .hero{padding:28px 0}
      .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
      .card{grid-column:span 12;background:var(--card);border:1px solid var(--border);border-radius:18px;padding:16px}
      @media(min-width:800px){.card.half{grid-column:span 6}}
      h1,h2,h3{margin:0 0 10px}
      p{margin:8px 0;color:var(--muted);line-height:1.55}
      footer{border-top:1px solid var(--border);margin-top:28px}
      .lang{margin-left:auto;display:flex;gap:8px;align-items:center}
      .muted{color:var(--muted)}
      .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:rgba(255,255,255,.04)}
      .btn:hover{background:rgba(255,255,255,.06);text-decoration:none}
      .k{font-size:12px;color:var(--muted)}
      .list{display:flex;flex-direction:column;gap:10px}
      .small{font-size:14px}
      .badge{font-size:12px;border:1px solid var(--border);border-radius:999px;padding:4px 8px;color:var(--muted)}
      .cols{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
      .cols .col{grid-column:span 12}
      @media(min-width:900px){.cols .col{grid-column:span 6}}
      input,textarea,select{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0f1320;color:var(--text)}
      textarea{min-height:110px}
      label{font-size:13px;color:var(--muted)}
      .formrow{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
      .formrow .span6{grid-column:span 12}
      @media(min-width:800px){.formrow .span6{grid-column:span 6}}
      .note{font-size:13px;color:var(--muted)}
      .hr{height:1px;background:var(--border);margin:14px 0}
      .embed{aspect-ratio:16/9;width:100%;border:1px solid var(--border);border-radius:14px;overflow:hidden;background:#000}
      .embed iframe{width:100%;height:100%}
    </style>
  </head>
  <body>
    <header>
      <div class="wrap">
        <div class="row">
          <a class="brand" href={`/${lang}/`}>YITUMU GLOBAL</a>
          <nav>
            {nav.map(i => <a class="pill" href={i.href}>{i.label}</a>)}
            <a class="pill" href={`/${lang}/blog/`}>{ui.blog}</a>
            <a class="pill" href={`/${lang}/about/`}>{ui.about}</a>
            <a class="pill" href={`/${lang}/contact/`}>{ui.contact}</a>
          </nav>

          <div class="lang">
            <span class="k">{ui.langLabel}:</span>
            <select id="langSelect" aria-label="Language" data-current={lang}>
              <option value="en">English</option>
              <option value="es">Español</option>
              <option value="fr">Français</option>
              <option value="de">Deutsch</option>
              <option value="it">Italiano</option>
            </select>
          </div>
        </div>
      </div>
    </header>

    <script is:inline>
      (function(){
        const sel = document.getElementById('langSelect');
        if (!sel) return;
        const current = sel.getAttribute('data-current') || 'en';
        sel.value = current;

        function switchTo(next){
          const p = window.location.pathname || '/';
          const parts = p.split('/').filter(Boolean);
          if (parts.length === 0) { window.location.href = '/' + next + '/'; return; }
          // If first segment is a locale, replace it; otherwise prefix.
          const locales = new Set(['en','es','fr','de','it']);
          if (locales.has(parts[0])) parts[0] = next;
          else parts.unshift(next);
          const newPath = '/' + parts.join('/') + '/';
          window.location.href = newPath + window.location.search + window.location.hash;
        }

        sel.addEventListener('change', (e)=>{
          const next = sel.value;
          if (!next || next===current) return;
          switchTo(next);
        });
      })();
    </script>

    <main class="wrap">
      <slot />
    </main>

    <footer>
      <div class="wrap small muted">
        <div>© {new Date().getFullYear()} {settings?.site_name ?? 'YITUMU GLOBAL'} · {settings?.sales_email ?? 'sales@yitumuglobal.com'}</div>
      </div>
    </footer>
  </body>
</html>
